<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>props로 전달받은 값을 마음대로 변경하면 안됩니다.</title>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
</head>
<body>
<!-- 
  1.Prop being mutated: "hp" 오류 발생
  2. backtick[백틱](`)문자  
         자바스크립트에서 backtick[백틱](`)문자를 사용하여 문자열을 표현한 것을 템플릿 리터럴이라고 합니다.
         이것을 사용해서 줄바꿈과 문자열 내부에 표현식을 포함할 수 있습니다.    
     (1) 문자열 줄바꿈
          console.log(`안녕하세요?하하`);
     (2) 표현식    
         let str = `${a2}와 ${b2}의 나이를 합산하면 ${c2 + d2}살 입니다.`; 
 -->
 <div id="app">
  <comp-child v-for="item in list"
              v-bind:key="item.id"
              v-bind="item"
              v-on:attack="handleAttack"></comp-child>
 
</div>
  <script>
  Vue.component('my-component',{
	  template:'<p><comp-child></comp-child></p>'
  })
   Vue.component('comp-child',{
	  template:`<li>{{name}} HP.{{hp}}
	             <button v-on:click="doAttack">공격하기</button></li>`,
	  props:{id:Number, name:String, hp:Number},//v-bind="item"
	  methods:{		 
		  doAttack:function(){
	      //버튼 클릭 이벤트 핸들러에서 $emit으로 부모의 attack이벤트 호출하기
	      //this.id는 선택한 item의 아이디값이 attack이벤트를 실행하기위한 메서드 handleAttack의 매개변수에 전달됩니다.
	      //handleAttack:function(id){..}에서 id로 받습니다.
			 this.$emit('attack',this.id);
		  }
	  }
  })
  new Vue({
	  el:"#app",
	  data:{
		  list:[
			  {id:1, name:'슬라임',hp:100},
			  {id:2, name:'고블린',hp:200},
			  {id:3, name:'드래곤',hp:500}
		  ]
	  },
	  methods:{
		  //attack이 발생한 경우
		  handleAttack:function(id){
			  var item = this.list.find(function(el){
				  return el.id === id;
			  })
			  
			  //HP가 0보다 많을 때는 10씩 줄임
			  if(item !== undefined && item.hp >0 ) item.hp -= 10;
		  }  
	  }
  })
  </script>
</body>
</html>